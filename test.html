<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Whatajong</title>
    <link rel="stylesheet" href="css/whatajong.css" type="text/css" media="screen">
    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/raphael.js"></script>
    <script>
      $(function () {
        var now = Date.now();
        var SIDE_SIZE = 8
          , TILE_HEIGHT = 65
          , TILE_WIDTH = 45
          , TILE_THEIGHT = TILE_HEIGHT + SIDE_SIZE
          , TILE_TWIDTH = TILE_WIDTH + SIDE_SIZE
          , COLUMNS = 8
          , ROWS = 15
          , paper = Raphael(
              $('#canvas').get(0)
            , (ROWS * TILE_WIDTH) + (2 * SIDE_SIZE), (COLUMNS * TILE_HEIGHT) + (2 * SIDE_SIZE)
            );
        var x = (1 - 1) * 45 / 2
          , y = 1 * 65 / 2
          , z = 0
          , shadow_attr = {stroke: '', fill: '#000', 'fill-opacity': 0.1}
          , set = paper.set()
          , left_side, bottom_side, body, shape, shadow_right, shadow_up;

        x = z ? x + (z * SIDE_SIZE) : x;
        y = SIDE_SIZE + (z ? y - (z * SIDE_SIZE) : y);

        left_side = paper.path([ 'M', x, y + SIDE_SIZE, 'L', x + SIDE_SIZE, y, 'L', x + SIDE_SIZE, y + TILE_HEIGHT
                               , 'L', x, y + TILE_THEIGHT, 'L', x, y + SIDE_SIZE].join(' '));
        bottom_side = paper.path([ 'M', x, y + TILE_THEIGHT, 'L', x + SIDE_SIZE, y + TILE_HEIGHT
                                 , 'L', x + TILE_TWIDTH, y + TILE_HEIGHT, 'L', x + TILE_WIDTH, y + TILE_THEIGHT
                                 , 'L', x, y + TILE_THEIGHT].join(' '));
        body = paper.path([ 'M', x + SIDE_SIZE, y, 'L', x + TILE_TWIDTH, y, 'L', x + TILE_TWIDTH, y + TILE_HEIGHT
                          , 'L', x + SIDE_SIZE, y + TILE_HEIGHT, 'L', x + SIDE_SIZE, y].join(' '));
        c = paper.image("tiles.png", x + SIDE_SIZE, y, TILE_WIDTH * 9, TILE_HEIGHT * 5);
        shape = paper.path([ 'M', x, y + SIDE_SIZE, 'L', x + SIDE_SIZE, y, 'L', x + TILE_TWIDTH, y
                           , 'L', x + TILE_TWIDTH, y + TILE_HEIGHT, 'L', x + TILE_WIDTH, y + TILE_THEIGHT
                           , 'L', x, y + TILE_THEIGHT, 'L', x, y + SIDE_SIZE].join(' '));
        left_side.attr({fill: '#FFBB89', stroke: ''});
        bottom_side.attr({fill: '#FF9966', stroke: ''});
        body.attr({fill: '#FEE1A9', stroke: ''});
        shape.attr({stroke: '#664433', 'stroke-width': 2, cursor: 'pointer', fill: '#fff', 'fill-opacity': 0});
        c.attr({'clip-rect': [x + SIDE_SIZE, y, TILE_WIDTH, TILE_HEIGHT]});

        console.log(Date.now() - now);
        shape.click(function () {
          this.attr({'fill-opacity': 0.6, fill: '#FFAA33'});
        });
        shape.hover(function () {
          this.attr({'fill-opacity': 0.3});
        }, function () {
          this.attr({'fill-opacity': 0});
        });

        set.push(left_side, bottom_side, body, shape, shadow_up, shadow_right);
      });
    </script>
  </head>
  <body>
    <div id='canvas'></div>
  </body>
</html>
